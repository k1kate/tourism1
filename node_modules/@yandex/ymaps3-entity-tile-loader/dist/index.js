(()=>{var e={705:(e,t,r)=>{var i=r(639).Symbol;e.exports=i},239:(e,t,r)=>{var i=r(705),o=r(607),n=r(333),a=i?i.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?o(e):n(e)}},561:(e,t,r)=>{var i=r(990),o=/^\s+/;e.exports=function(e){return e?e.slice(0,i(e)+1).replace(o,""):e}},957:(e,t,r)=>{var i="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;e.exports=i},607:(e,t,r)=>{var i=r(705),o=Object.prototype,n=o.hasOwnProperty,a=o.toString,s=i?i.toStringTag:void 0;e.exports=function(e){var t=n.call(e,s),r=e[s];try{e[s]=void 0;var i=!0}catch(e){}var o=a.call(e);return i&&(t?e[s]=r:delete e[s]),o}},333:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},639:(e,t,r)=>{var i=r(957),o="object"==typeof self&&self&&self.Object===Object&&self,n=i||o||Function("return this")();e.exports=n},990:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},279:(e,t,r)=>{var i=r(218),o=r(771),n=r(841),a=Math.max,s=Math.min;e.exports=function(e,t,r){var l,u,c,f,d,p,v=0,y=!1,_=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var r=l,i=u;return l=u=void 0,v=t,f=e.apply(i,r)}function x(e){var r=e-p;return void 0===p||r>=t||r<0||_&&e-v>=c}function T(){var e=o();if(x(e))return b(e);d=setTimeout(T,function(e){var r=t-(e-p);return _?s(r,c-(e-v)):r}(e))}function b(e){return d=void 0,h&&l?m(e):(l=u=void 0,f)}function g(){var e=o(),r=x(e);if(l=arguments,u=this,p=e,r){if(void 0===d)return function(e){return v=e,d=setTimeout(T,t),y?m(e):f}(p);if(_)return clearTimeout(d),d=setTimeout(T,t),m(p)}return void 0===d&&(d=setTimeout(T,t)),f}return t=n(t)||0,i(r)&&(y=!!r.leading,c=(_="maxWait"in r)?a(n(r.maxWait)||0,t):c,h="trailing"in r?!!r.trailing:h),g.cancel=function(){void 0!==d&&clearTimeout(d),v=0,l=p=u=d=void 0},g.flush=function(){return void 0===d?f:b(o())},g}},218:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},5:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},448:(e,t,r)=>{var i=r(239),o=r(5);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==i(e)}},771:(e,t,r)=>{var i=r(639);e.exports=function(){return i.Date.now()}},493:(e,t,r)=>{var i=r(279),o=r(218);e.exports=function(e,t,r){var n=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return o(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),i(e,t,{leading:n,maxWait:t,trailing:a})}},841:(e,t,r)=>{var i=r(561),o=r(218),n=r(448),a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(n(e))return NaN;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=i(e);var r=s.test(e);return r||l.test(e)?u(e.slice(2),r?2:8):a.test(e)?NaN:+e}},309:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.YMapEntityTileLoader=void 0;const o=r(693),n=r(865),a=i(r(493));class s extends ymaps3.YMapComplexEntity{constructor(e){super({removalDelay:0,...e},{container:!0}),this._tiles=new Map,this._entities=new Map,this._markedForDeletion=new Set,this._listener=new ymaps3.YMapListener({onUpdate:({mapInAction:e})=>{e||this._reconcileTiles()}}),this._addDirectChild(this._listener),this._requestRemoveFeatures=(0,a.default)((()=>this._removeEntities()),this._props.removalDelay)}_onUpdate({removalDelay:e}){void 0!==e&&(this._removeEntities(),this._requestRemoveFeatures.cancel(),this._requestRemoveFeatures=(0,a.default)((()=>this._removeEntities()),e))}_onDetach(){for(const e of this.children)this.removeChild(e);this._tiles.clear(),this._entities.clear(),this._requestRemoveFeatures.cancel()}_onAttach(){this._reconcileTiles()}_reconcileTiles(){const{projection:e,zoom:t,center:r,size:i}=this.root,o=(0,n.getTilesForViewport)({projection:e,zoom:t,center:r,size:i,tileSize:this._props.tileSize}),a=new Map;for(const e of o)a.set(`${e.tx}_${e.ty}_${e.tz}`,e);for(const[e,t]of a.entries()){if(this._tiles.has(e))continue;const r={...t,abortController:new AbortController,entities:new Map,promise:Promise.resolve()};r.promise=this._fetchTile(r),this._tiles.set(e,r)}for(const[e,t]of this._tiles.entries())if(!a.has(e)){this._tiles.delete(e);for(const e of t.entities.values())e.refcount--,0===e.refcount&&this._markedForDeletion.add(e);t.abortController.abort()}this._requestRemoveFeatures()}async _fetchTile(e){const[t,r]=await this._props.fetchTile({tx:e.tx,ty:e.ty,tz:e.tz,signal:e.abortController.signal}).then((e=>[!0,e]),(e=>[!1,e]));if(!t||!Array.isArray(r)){if(!r||r instanceof DOMException&&"AbortError"===r.name)return;throw r}for(const t of r){const r=this._props.getFeatureId(t);if(e.entities.has(r))continue;const i=this._entities.get(r),o=null!=i?i:{id:r,feature:t,refcount:0};o.refcount++,e.entities.set(r,o),i||(this._entities.set(r,o),this.__addEntity(o))}}_removeEntities(){for(const e of this._markedForDeletion)0===e.refcount&&(this._entities.delete(e.id),this.__removeEntity(e));this._markedForDeletion.clear()}__addEntity(e){var t,r;!1!==(null===(r=(t=this._props).onFeatureAdd)||void 0===r?void 0:r.call(t,e.feature))&&(e.entity||(e.entity=this._props.entity(e.feature)),this._addDirectChild(e.entity))}__removeEntity(e){var t,r;!1!==(null===(r=(t=this._props).onFeatureRemove)||void 0===r?void 0:r.call(t,e.feature))&&this._removeDirectChild(e.entity)}}t.YMapEntityTileLoader=s,s[ymaps3.overrideKeyReactify]=o.YMapEntityTileLoaderReactifyOverride},558:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeTileBounds=void 0,t.computeTileBounds=(e,t,r,i)=>{const o=t.x/(2*r),n=t.y/(2*r);let a={x:e.x-o,y:e.y-n};a={x:a.x/i,y:a.y/i},a={x:Math.floor(a.x),y:Math.floor(a.y)};let s={x:e.x+o,y:e.y+n};return s={x:s.x/i,y:s.y/i},s={x:Math.floor(s.x),y:Math.floor(s.y)},{minX:a.x,minY:a.y,maxX:s.x,maxY:s.y}}},865:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTilesForViewport=void 0;const i=r(558);t.getTilesForViewport=function({projection:e,zoom:t,center:r,tileSize:o,size:n}){const a=Math.floor(t),s=2**(t-a),l=e.toWorldCoordinates([...r]),u=2**a/2*256,c={x:(l.x+1)*u,y:(1-l.y)*u},f=(0,i.computeTileBounds)(c,n,s,o),d=[];for(let e=f.minX;e<=f.maxX;e++)for(let t=f.minY;t<=f.maxY;t++)d.push({tx:e,ty:t,tz:a});return d}},65:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,o)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(309),t)},693:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.YMapEntityTileLoaderReactifyOverride=t.DEFAULT_THROTTLE_TIMOUT=void 0;const o=i(r(493));t.DEFAULT_THROTTLE_TIMOUT=300,t.YMapEntityTileLoaderReactifyOverride=(e,{reactify:r,React:i})=>{const n=r.entity(e),a=i.memo((({features:e,getFeatureId:t,entity:r})=>i.createElement(i.Fragment,null,e.map((e=>i.createElement(i.Fragment,{key:t(e)},r(e)))))));return i.forwardRef(((e,r)=>{var s;const[l,u]=i.useState([]),c=i.useMemo((()=>{var r;return(0,o.default)(u,null!==(r=e.renderDelay)&&void 0!==r?r:t.DEFAULT_THROTTLE_TIMOUT)}),[null!==(s=e.renderDelay)&&void 0!==s?s:t.DEFAULT_THROTTLE_TIMOUT]),f=i.useCallback((t=>{var r;return null===(r=e.onFeatureAdd)||void 0===r||r.call(e,t),l.includes(t)||l.push(t),c([...l]),!1}),[l]),d=i.useCallback((t=>{var r;null===(r=e.onFeatureRemove)||void 0===r||r.call(e,t);const i=l.indexOf(t);return-1!==i&&l.splice(i,1),c([...l]),!1}),[l]);return i.createElement(i.Fragment,null,i.createElement(n,{...e,ref:r,onFeatureAdd:f,onFeatureRemove:d}),i.createElement(a,{features:l,getFeatureId:e.getFeatureId,entity:e.entity}))}))}},341:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,o)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(65),t),o(r(683),t)},683:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})}},t={};function r(i){var o=t[i];if(void 0!==o)return o.exports;var n=t[i]={exports:{}};return e[i].call(n.exports,n,n.exports,r),n.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var i=r(341);self["@yandex/ymaps3-entity-tile-loader"]=i})();